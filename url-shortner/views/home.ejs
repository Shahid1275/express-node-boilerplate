<!DOCTYPE html>
<html>
<head>
    <title>URL Shortener</title>
    <style>
        body { font-family: Arial; max-width: 800px; margin: 0 auto; padding: 20px; }
        form { display: flex; gap: 10px; margin: 20px 0; }
        input { flex: 1; padding: 8px; }
        button { padding: 8px 15px; background: #4CAF50; color: white; border: none; cursor: pointer; }
        table { width: 100%; border-collapse: collapse; margin-top: 20px; }
        th, td { padding: 10px; text-align: left; border-bottom: 1px solid #ddd; }
        th { background-color: #f2f2f2; }
        a { color: #4CAF50; text-decoration: none; }
        a:hover { text-decoration: underline; }
        .success-message { color: #4CAF50; margin: 15px 0; }
    </style>
</head>
<body>
    <h1>URL Shortener</h1>
    
    <% if (locals.id) { %>
        <div class="success-message">
            Generated Short URL: <a href="/<%= locals.id %>"><%= locals.protocol %>://<%= locals.host %>/<%= locals.id %></a>
        </div>
    <% } %>
    
    <form method="POST" action="/url">
        <input type="url" name="url" placeholder="Enter URL" required>
        <button type="submit">Shorten</button>
    </form>

    <% if (locals.urls && locals.urls.length > 0) { %>
        <table>
            <thead>
                <tr>
                    <th>S. No</th>
                    <th>Short ID</th>
                    <th>Original URL</th>
                    <th>Visits</th>
                </tr>
            </thead>
            <tbody>
                <% locals.urls.forEach((url, index) => { %>
                    <tr>
                        <td><%= index + 1 %></td>
                        <td><a href="/<%= url.shortId %>"><%= url.shortId %></a></td>
                        <td><a href="<%= url.redirectUrl %>" target="_blank"><%= url.redirectUrl %></a></td>
                        <td><%= url.visitHistory.length %></td>
                    </tr>
                <% }); %>
            </tbody>
        </table>
    <% } else { %>
        <p>No URLs have been shortened yet.</p>
    <% } %>
</body>
</html>